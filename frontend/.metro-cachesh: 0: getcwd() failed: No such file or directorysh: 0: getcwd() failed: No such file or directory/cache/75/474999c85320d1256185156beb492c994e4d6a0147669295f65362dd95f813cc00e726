{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":69,"index":69}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-crypto","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":70},"end":{"line":2,"column":38,"index":108}}],"key":"+Akla+LrhuGGU54C9zXxLPlFUv4=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":109},"end":{"line":3,"column":26,"index":135}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"OfflineTradeService\", {\n    enumerable: true,\n    get: function () {\n      return OfflineTradeService;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoCrypto = require(_dependencyMap[2], \"expo-crypto\");\n  var Crypto = _interopNamespace(_expoCrypto);\n  var _axios = require(_dependencyMap[3], \"axios\");\n  var axios = _interopDefault(_axios);\n  const API_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const STORAGE_KEY = '@offline_trades';\n  class OfflineTradeService {\n    static async recordTrade(payerId, payerName, payeeId, payeeName, items, payerSignature, payeeSignature) {\n      const trade = {\n        trade_id: `trade-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        timestamp: Date.now(),\n        payer_id: payerId,\n        payer_name: payerName,\n        payee_id: payeeId,\n        payee_name: payeeName,\n        items: items,\n        total_value: items.reduce((sum, item) => sum + item.value, 0),\n        status: 'pending',\n        payer_signature: payerSignature,\n        payee_signature: payeeSignature\n      };\n      await this.saveTrade(trade);\n      return trade;\n    }\n    static async saveTrade(trade) {\n      const trades = await this.getPendingTrades();\n      trades.push(trade);\n      await AsyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(trades));\n    }\n    static async getPendingTrades() {\n      try {\n        const json = await AsyncStorage.default.getItem(STORAGE_KEY);\n        return json ? JSON.parse(json) : [];\n      } catch (error) {\n        console.error('Error getting pending trades:', error);\n        return [];\n      }\n    }\n    static async syncPendingTrades() {\n      const trades = await this.getPendingTrades();\n      let synced = 0;\n      let failed = 0;\n      for (const trade of trades) {\n        if (trade.status === 'synced') continue;\n        try {\n          await axios.default.post(`${API_URL}/api/trades`, {\n            payer_id: trade.payer_id,\n            payee_id: trade.payee_id,\n            items: trade.items,\n            total_value: trade.total_value,\n            payer_signature: trade.payer_signature,\n            payee_signature: trade.payee_signature\n          });\n          trade.status = 'synced';\n          synced++;\n        } catch (error) {\n          console.error('Failed to sync trade:', trade.trade_id, error);\n          trade.status = 'failed';\n          failed++;\n        }\n      }\n      const remainingTrades = trades.filter(t => t.status !== 'synced');\n      await AsyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(remainingTrades));\n      return {\n        synced,\n        failed\n      };\n    }\n    static async generateSignature(data, pin) {\n      const dataString = JSON.stringify(data);\n      const combined = `${dataString}:${pin}`;\n      const hash = await Crypto.digestStringAsync(Crypto.CryptoDigestAlgorithm.SHA256, combined);\n      return hash;\n    }\n    static async clearAllTrades() {\n      await AsyncStorage.default.removeItem(STORAGE_KEY);\n    }\n  }\n});","lineCount":114,"map":[[27,2,31,0,"Object"],[27,8,31,0],[27,9,31,0,"defineProperty"],[27,23,31,0],[27,24,31,0,"exports"],[27,31,31,0],[28,4,31,0,"enumerable"],[28,14,31,0],[29,4,31,0,"get"],[29,7,31,0],[29,18,31,0,"get"],[29,19,31,0],[30,6,31,0],[30,13,31,0,"OfflineTradeService"],[30,32,31,0],[31,4,31,0],[32,2,31,0],[33,2,121,1],[33,6,121,1,"_expoVirtualEnv"],[33,21,121,1],[33,24,121,1,"require"],[33,31,121,1],[33,32,121,1,"_dependencyMap"],[33,46,121,1],[34,2,1,0],[34,6,1,0,"_reactNativeAsyncStorageAsyncStorage"],[34,42,1,0],[34,45,1,0,"require"],[34,52,1,0],[34,53,1,0,"_dependencyMap"],[34,67,1,0],[35,2,1,0],[35,6,1,0,"AsyncStorage"],[35,18,1,0],[35,21,1,0,"_interopDefault"],[35,36,1,0],[35,37,1,0,"_reactNativeAsyncStorageAsyncStorage"],[35,73,1,0],[36,2,2,0],[36,6,2,0,"_expoCrypto"],[36,17,2,0],[36,20,2,0,"require"],[36,27,2,0],[36,28,2,0,"_dependencyMap"],[36,42,2,0],[37,2,2,0],[37,6,2,0,"Crypto"],[37,12,2,0],[37,15,2,0,"_interopNamespace"],[37,32,2,0],[37,33,2,0,"_expoCrypto"],[37,44,2,0],[38,2,3,0],[38,6,3,0,"_axios"],[38,12,3,0],[38,15,3,0,"require"],[38,22,3,0],[38,23,3,0,"_dependencyMap"],[38,37,3,0],[39,2,3,0],[39,6,3,0,"axios"],[39,11,3,0],[39,14,3,0,"_interopDefault"],[39,29,3,0],[39,30,3,0,"_axios"],[39,36,3,0],[40,2,5,0],[40,8,5,6,"API_URL"],[40,15,5,13],[40,18,5,13,"_expoVirtualEnv"],[40,33,5,13],[40,34,5,13,"env"],[40,37,5,13],[40,38,5,13,"EXPO_PUBLIC_BACKEND_URL"],[40,61,5,51],[41,2,6,0],[41,8,6,6,"STORAGE_KEY"],[41,19,6,17],[41,22,6,20],[41,39,6,37],[42,2,31,7],[42,8,31,13,"OfflineTradeService"],[42,27,31,32],[42,28,31,33],[43,4,32,2],[43,17,32,15,"recordTrade"],[43,28,32,26,"recordTrade"],[43,29,33,4,"payerId"],[43,36,33,19],[43,38,34,4,"payerName"],[43,47,34,21],[43,49,35,4,"payeeId"],[43,56,35,19],[43,58,36,4,"payeeName"],[43,67,36,21],[43,69,37,4,"items"],[43,74,37,22],[43,76,38,4,"payerSignature"],[43,90,38,26],[43,92,39,4,"payeeSignature"],[43,106,39,26],[43,108,40,27],[44,6,41,4],[44,12,41,10,"trade"],[44,17,41,29],[44,20,41,32],[45,8,42,6,"trade_id"],[45,16,42,14],[45,18,42,16],[45,27,42,25,"Date"],[45,31,42,29],[45,32,42,30,"now"],[45,35,42,33],[45,36,42,34],[45,37,42,35],[45,41,42,39,"Math"],[45,45,42,43],[45,46,42,44,"random"],[45,52,42,50],[45,53,42,51],[45,54,42,52],[45,55,42,53,"toString"],[45,63,42,61],[45,64,42,62],[45,66,42,64],[45,67,42,65],[45,68,42,66,"substr"],[45,74,42,72],[45,75,42,73],[45,76,42,74],[45,78,42,76],[45,79,42,77],[45,80,42,78],[45,82,42,80],[46,8,43,6,"timestamp"],[46,17,43,15],[46,19,43,17,"Date"],[46,23,43,21],[46,24,43,22,"now"],[46,27,43,25],[46,28,43,26],[46,29,43,27],[47,8,44,6,"payer_id"],[47,16,44,14],[47,18,44,16,"payerId"],[47,25,44,23],[48,8,45,6,"payer_name"],[48,18,45,16],[48,20,45,18,"payerName"],[48,29,45,27],[49,8,46,6,"payee_id"],[49,16,46,14],[49,18,46,16,"payeeId"],[49,25,46,23],[50,8,47,6,"payee_name"],[50,18,47,16],[50,20,47,18,"payeeName"],[50,29,47,27],[51,8,48,6,"items"],[51,13,48,11],[51,15,48,13,"items"],[51,20,48,18],[52,8,49,6,"total_value"],[52,19,49,17],[52,21,49,19,"items"],[52,26,49,24],[52,27,49,25,"reduce"],[52,33,49,31],[52,34,49,32],[52,35,49,33,"sum"],[52,38,49,36],[52,40,49,38,"item"],[52,44,49,42],[52,49,49,47,"sum"],[52,52,49,50],[52,55,49,53,"item"],[52,59,49,57],[52,60,49,58,"value"],[52,65,49,63],[52,67,49,65],[52,68,49,66],[52,69,49,67],[53,8,50,6,"status"],[53,14,50,12],[53,16,50,14],[53,25,50,23],[54,8,51,6,"payer_signature"],[54,23,51,21],[54,25,51,23,"payerSignature"],[54,39,51,37],[55,8,52,6,"payee_signature"],[55,23,52,21],[55,25,52,23,"payeeSignature"],[56,6,53,4],[56,7,53,5],[57,6,55,4],[57,12,55,10],[57,16,55,14],[57,17,55,15,"saveTrade"],[57,26,55,24],[57,27,55,25,"trade"],[57,32,55,30],[57,33,55,31],[58,6,56,4],[58,13,56,11,"trade"],[58,18,56,16],[59,4,57,2],[60,4,59,2],[60,17,59,15,"saveTrade"],[60,26,59,24,"saveTrade"],[60,27,59,25,"trade"],[60,32,59,44],[60,34,59,61],[61,6,60,4],[61,12,60,10,"trades"],[61,18,60,16],[61,21,60,19],[61,27,60,25],[61,31,60,29],[61,32,60,30,"getPendingTrades"],[61,48,60,46],[61,49,60,47],[61,50,60,48],[62,6,61,4,"trades"],[62,12,61,10],[62,13,61,11,"push"],[62,17,61,15],[62,18,61,16,"trade"],[62,23,61,21],[62,24,61,22],[63,6,62,4],[63,12,62,10,"AsyncStorage"],[63,24,62,22],[63,25,62,22,"default"],[63,32,62,22],[63,33,62,23,"setItem"],[63,40,62,30],[63,41,62,31,"STORAGE_KEY"],[63,52,62,42],[63,54,62,44,"JSON"],[63,58,62,48],[63,59,62,49,"stringify"],[63,68,62,58],[63,69,62,59,"trades"],[63,75,62,65],[63,76,62,66],[63,77,62,67],[64,4,63,2],[65,4,65,2],[65,17,65,15,"getPendingTrades"],[65,33,65,31,"getPendingTrades"],[65,34,65,31],[65,36,65,59],[66,6,66,4],[66,10,66,8],[67,8,67,6],[67,14,67,12,"json"],[67,18,67,16],[67,21,67,19],[67,27,67,25,"AsyncStorage"],[67,39,67,37],[67,40,67,37,"default"],[67,47,67,37],[67,48,67,38,"getItem"],[67,55,67,45],[67,56,67,46,"STORAGE_KEY"],[67,67,67,57],[67,68,67,58],[68,8,68,6],[68,15,68,13,"json"],[68,19,68,17],[68,22,68,20,"JSON"],[68,26,68,24],[68,27,68,25,"parse"],[68,32,68,30],[68,33,68,31,"json"],[68,37,68,35],[68,38,68,36],[68,41,68,39],[68,43,68,41],[69,6,69,4],[69,7,69,5],[69,8,69,6],[69,15,69,13,"error"],[69,20,69,18],[69,22,69,20],[70,8,70,6,"console"],[70,15,70,13],[70,16,70,14,"error"],[70,21,70,19],[70,22,70,20],[70,53,70,51],[70,55,70,53,"error"],[70,60,70,58],[70,61,70,59],[71,8,71,6],[71,15,71,13],[71,17,71,15],[72,6,72,4],[73,4,73,2],[74,4,75,2],[74,17,75,15,"syncPendingTrades"],[74,34,75,32,"syncPendingTrades"],[74,35,75,32],[74,37,75,80],[75,6,76,4],[75,12,76,10,"trades"],[75,18,76,16],[75,21,76,19],[75,27,76,25],[75,31,76,29],[75,32,76,30,"getPendingTrades"],[75,48,76,46],[75,49,76,47],[75,50,76,48],[76,6,77,4],[76,10,77,8,"synced"],[76,16,77,14],[76,19,77,17],[76,20,77,18],[77,6,78,4],[77,10,78,8,"failed"],[77,16,78,14],[77,19,78,17],[77,20,78,18],[78,6,80,4],[78,11,80,9],[78,17,80,15,"trade"],[78,22,80,20],[78,26,80,24,"trades"],[78,32,80,30],[78,34,80,32],[79,8,81,6],[79,12,81,10,"trade"],[79,17,81,15],[79,18,81,16,"status"],[79,24,81,22],[79,29,81,27],[79,37,81,35],[79,39,81,37],[80,8,83,6],[80,12,83,10],[81,10,84,8],[81,16,84,14,"axios"],[81,21,84,19],[81,22,84,19,"default"],[81,29,84,19],[81,30,84,20,"post"],[81,34,84,24],[81,35,84,25],[81,38,84,28,"API_URL"],[81,45,84,35],[81,58,84,48],[81,60,84,50],[82,12,85,10,"payer_id"],[82,20,85,18],[82,22,85,20,"trade"],[82,27,85,25],[82,28,85,26,"payer_id"],[82,36,85,34],[83,12,86,10,"payee_id"],[83,20,86,18],[83,22,86,20,"trade"],[83,27,86,25],[83,28,86,26,"payee_id"],[83,36,86,34],[84,12,87,10,"items"],[84,17,87,15],[84,19,87,17,"trade"],[84,24,87,22],[84,25,87,23,"items"],[84,30,87,28],[85,12,88,10,"total_value"],[85,23,88,21],[85,25,88,23,"trade"],[85,30,88,28],[85,31,88,29,"total_value"],[85,42,88,40],[86,12,89,10,"payer_signature"],[86,27,89,25],[86,29,89,27,"trade"],[86,34,89,32],[86,35,89,33,"payer_signature"],[86,50,89,48],[87,12,90,10,"payee_signature"],[87,27,90,25],[87,29,90,27,"trade"],[87,34,90,32],[87,35,90,33,"payee_signature"],[88,10,91,8],[88,11,91,9],[88,12,91,10],[89,10,93,8,"trade"],[89,15,93,13],[89,16,93,14,"status"],[89,22,93,20],[89,25,93,23],[89,33,93,31],[90,10,94,8,"synced"],[90,16,94,14],[90,18,94,16],[91,8,95,6],[91,9,95,7],[91,10,95,8],[91,17,95,15,"error"],[91,22,95,20],[91,24,95,22],[92,10,96,8,"console"],[92,17,96,15],[92,18,96,16,"error"],[92,23,96,21],[92,24,96,22],[92,47,96,45],[92,49,96,47,"trade"],[92,54,96,52],[92,55,96,53,"trade_id"],[92,63,96,61],[92,65,96,63,"error"],[92,70,96,68],[92,71,96,69],[93,10,97,8,"trade"],[93,15,97,13],[93,16,97,14,"status"],[93,22,97,20],[93,25,97,23],[93,33,97,31],[94,10,98,8,"failed"],[94,16,98,14],[94,18,98,16],[95,8,99,6],[96,6,100,4],[97,6,102,4],[97,12,102,10,"remainingTrades"],[97,27,102,25],[97,30,102,28,"trades"],[97,36,102,34],[97,37,102,35,"filter"],[97,43,102,41],[97,44,102,43,"t"],[97,45,102,44],[97,49,102,49,"t"],[97,50,102,50],[97,51,102,51,"status"],[97,57,102,57],[97,62,102,62],[97,70,102,70],[97,71,102,71],[98,6,103,4],[98,12,103,10,"AsyncStorage"],[98,24,103,22],[98,25,103,22,"default"],[98,32,103,22],[98,33,103,23,"setItem"],[98,40,103,30],[98,41,103,31,"STORAGE_KEY"],[98,52,103,42],[98,54,103,44,"JSON"],[98,58,103,48],[98,59,103,49,"stringify"],[98,68,103,58],[98,69,103,59,"remainingTrades"],[98,84,103,74],[98,85,103,75],[98,86,103,76],[99,6,105,4],[99,13,105,11],[100,8,105,13,"synced"],[100,14,105,19],[101,8,105,21,"failed"],[102,6,105,28],[102,7,105,29],[103,4,106,2],[104,4,108,2],[104,17,108,15,"generateSignature"],[104,34,108,32,"generateSignature"],[104,35,108,33,"data"],[104,39,108,42],[104,41,108,44,"pin"],[104,44,108,55],[104,46,108,74],[105,6,109,4],[105,12,109,10,"dataString"],[105,22,109,20],[105,25,109,23,"JSON"],[105,29,109,27],[105,30,109,28,"stringify"],[105,39,109,37],[105,40,109,38,"data"],[105,44,109,42],[105,45,109,43],[106,6,110,4],[106,12,110,10,"combined"],[106,20,110,18],[106,23,110,21],[106,26,110,24,"dataString"],[106,36,110,34],[106,40,110,38,"pin"],[106,43,110,41],[106,45,110,43],[107,6,111,4],[107,12,111,10,"hash"],[107,16,111,14],[107,19,111,17],[107,25,111,23,"Crypto"],[107,31,111,29],[107,32,111,30,"digestStringAsync"],[107,49,111,47],[107,50,112,6,"Crypto"],[107,56,112,12],[107,57,112,13,"CryptoDigestAlgorithm"],[107,78,112,34],[107,79,112,35,"SHA256"],[107,85,112,41],[107,87,113,6,"combined"],[107,95,114,4],[107,96,114,5],[108,6,115,4],[108,13,115,11,"hash"],[108,17,115,15],[109,4,116,2],[110,4,118,2],[110,17,118,15,"clearAllTrades"],[110,31,118,29,"clearAllTrades"],[110,32,118,29],[110,34,118,47],[111,6,119,4],[111,12,119,10,"AsyncStorage"],[111,24,119,22],[111,25,119,22,"default"],[111,32,119,22],[111,33,119,23,"removeItem"],[111,43,119,33],[111,44,119,34,"STORAGE_KEY"],[111,55,119,45],[111,56,119,46],[112,4,120,2],[113,2,121,0],[114,0,121,1],[114,3]],"functionMap":{"names":["<global>","OfflineTradeService","recordTrade","items.reduce$argument_0","saveTrade","getPendingTrades","syncPendingTrades","trades.filter$argument_0","generateSignature","clearAllTrades"],"mappings":"AAA;OC8B;ECC;gCCiB,+BD;GDQ;EGE;GHI;EIE;GJQ;EKE;0CC2B,4BD;GLI;EOE;GPQ;EQE;GRE;CDC"},"hasCjsExports":false},"type":"js/module"}]}