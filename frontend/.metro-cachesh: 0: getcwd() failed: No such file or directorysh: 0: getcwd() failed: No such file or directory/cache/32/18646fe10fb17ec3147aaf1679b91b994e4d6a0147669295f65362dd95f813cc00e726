{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":69,"index":69}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-crypto","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":70},"end":{"line":2,"column":38,"index":108}}],"key":"+Akla+LrhuGGU54C9zXxLPlFUv4=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":109},"end":{"line":3,"column":26,"index":135}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"OfflineTradeService\", {\n    enumerable: true,\n    get: function () {\n      return OfflineTradeService;\n    }\n  });\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoCrypto = require(_dependencyMap[1], \"expo-crypto\");\n  var Crypto = _interopNamespace(_expoCrypto);\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  const API_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const STORAGE_KEY = '@offline_trades';\n  class OfflineTradeService {\n    static async recordTrade(payerId, payerName, payeeId, payeeName, items, payerSignature, payeeSignature) {\n      const trade = {\n        trade_id: `trade-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        timestamp: Date.now(),\n        payer_id: payerId,\n        payer_name: payerName,\n        payee_id: payeeId,\n        payee_name: payeeName,\n        items: items,\n        total_value: items.reduce((sum, item) => sum + item.value, 0),\n        status: 'pending',\n        payer_signature: payerSignature,\n        payee_signature: payeeSignature\n      };\n      await this.saveTrade(trade);\n      return trade;\n    }\n    static async saveTrade(trade) {\n      const trades = await this.getPendingTrades();\n      trades.push(trade);\n      await AsyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(trades));\n    }\n    static async getPendingTrades() {\n      try {\n        const json = await AsyncStorage.default.getItem(STORAGE_KEY);\n        return json ? JSON.parse(json) : [];\n      } catch (error) {\n        console.error('Error getting pending trades:', error);\n        return [];\n      }\n    }\n    static async syncPendingTrades() {\n      const trades = await this.getPendingTrades();\n      let synced = 0;\n      let failed = 0;\n      for (const trade of trades) {\n        if (trade.status === 'synced') continue;\n        try {\n          await axios.default.post(`${API_URL}/api/trades`, {\n            payer_id: trade.payer_id,\n            payee_id: trade.payee_id,\n            items: trade.items,\n            total_value: trade.total_value,\n            payer_signature: trade.payer_signature,\n            payee_signature: trade.payee_signature\n          });\n          trade.status = 'synced';\n          synced++;\n        } catch (error) {\n          console.error('Failed to sync trade:', trade.trade_id, error);\n          trade.status = 'failed';\n          failed++;\n        }\n      }\n      const remainingTrades = trades.filter(t => t.status !== 'synced');\n      await AsyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(remainingTrades));\n      return {\n        synced,\n        failed\n      };\n    }\n    static async generateSignature(data, pin) {\n      const dataString = JSON.stringify(data);\n      const combined = `${dataString}:${pin}`;\n      const hash = await Crypto.digestStringAsync(Crypto.CryptoDigestAlgorithm.SHA256, combined);\n      return hash;\n    }\n    static async clearAllTrades() {\n      await AsyncStorage.default.removeItem(STORAGE_KEY);\n    }\n  }\n});","lineCount":113,"map":[[27,2,31,0,"Object"],[27,8,31,0],[27,9,31,0,"defineProperty"],[27,23,31,0],[27,24,31,0,"exports"],[27,31,31,0],[28,4,31,0,"enumerable"],[28,14,31,0],[29,4,31,0,"get"],[29,7,31,0],[29,18,31,0,"get"],[29,19,31,0],[30,6,31,0],[30,13,31,0,"OfflineTradeService"],[30,32,31,0],[31,4,31,0],[32,2,31,0],[33,2,1,0],[33,6,1,0,"_reactNativeAsyncStorageAsyncStorage"],[33,42,1,0],[33,45,1,0,"require"],[33,52,1,0],[33,53,1,0,"_dependencyMap"],[33,67,1,0],[34,2,1,0],[34,6,1,0,"AsyncStorage"],[34,18,1,0],[34,21,1,0,"_interopDefault"],[34,36,1,0],[34,37,1,0,"_reactNativeAsyncStorageAsyncStorage"],[34,73,1,0],[35,2,2,0],[35,6,2,0,"_expoCrypto"],[35,17,2,0],[35,20,2,0,"require"],[35,27,2,0],[35,28,2,0,"_dependencyMap"],[35,42,2,0],[36,2,2,0],[36,6,2,0,"Crypto"],[36,12,2,0],[36,15,2,0,"_interopNamespace"],[36,32,2,0],[36,33,2,0,"_expoCrypto"],[36,44,2,0],[37,2,3,0],[37,6,3,0,"_axios"],[37,12,3,0],[37,15,3,0,"require"],[37,22,3,0],[37,23,3,0,"_dependencyMap"],[37,37,3,0],[38,2,3,0],[38,6,3,0,"axios"],[38,11,3,0],[38,14,3,0,"_interopDefault"],[38,29,3,0],[38,30,3,0,"_axios"],[38,36,3,0],[39,2,5,0],[39,8,5,6,"API_URL"],[39,15,5,13],[39,18,5,16,"process"],[39,25,5,23],[39,26,5,24,"env"],[39,29,5,27],[39,30,5,28,"EXPO_PUBLIC_BACKEND_URL"],[39,53,5,51],[40,2,6,0],[40,8,6,6,"STORAGE_KEY"],[40,19,6,17],[40,22,6,20],[40,39,6,37],[41,2,31,7],[41,8,31,13,"OfflineTradeService"],[41,27,31,32],[41,28,31,33],[42,4,32,2],[42,17,32,15,"recordTrade"],[42,28,32,26,"recordTrade"],[42,29,33,4,"payerId"],[42,36,33,19],[42,38,34,4,"payerName"],[42,47,34,21],[42,49,35,4,"payeeId"],[42,56,35,19],[42,58,36,4,"payeeName"],[42,67,36,21],[42,69,37,4,"items"],[42,74,37,22],[42,76,38,4,"payerSignature"],[42,90,38,26],[42,92,39,4,"payeeSignature"],[42,106,39,26],[42,108,40,27],[43,6,41,4],[43,12,41,10,"trade"],[43,17,41,29],[43,20,41,32],[44,8,42,6,"trade_id"],[44,16,42,14],[44,18,42,16],[44,27,42,25,"Date"],[44,31,42,29],[44,32,42,30,"now"],[44,35,42,33],[44,36,42,34],[44,37,42,35],[44,41,42,39,"Math"],[44,45,42,43],[44,46,42,44,"random"],[44,52,42,50],[44,53,42,51],[44,54,42,52],[44,55,42,53,"toString"],[44,63,42,61],[44,64,42,62],[44,66,42,64],[44,67,42,65],[44,68,42,66,"substr"],[44,74,42,72],[44,75,42,73],[44,76,42,74],[44,78,42,76],[44,79,42,77],[44,80,42,78],[44,82,42,80],[45,8,43,6,"timestamp"],[45,17,43,15],[45,19,43,17,"Date"],[45,23,43,21],[45,24,43,22,"now"],[45,27,43,25],[45,28,43,26],[45,29,43,27],[46,8,44,6,"payer_id"],[46,16,44,14],[46,18,44,16,"payerId"],[46,25,44,23],[47,8,45,6,"payer_name"],[47,18,45,16],[47,20,45,18,"payerName"],[47,29,45,27],[48,8,46,6,"payee_id"],[48,16,46,14],[48,18,46,16,"payeeId"],[48,25,46,23],[49,8,47,6,"payee_name"],[49,18,47,16],[49,20,47,18,"payeeName"],[49,29,47,27],[50,8,48,6,"items"],[50,13,48,11],[50,15,48,13,"items"],[50,20,48,18],[51,8,49,6,"total_value"],[51,19,49,17],[51,21,49,19,"items"],[51,26,49,24],[51,27,49,25,"reduce"],[51,33,49,31],[51,34,49,32],[51,35,49,33,"sum"],[51,38,49,36],[51,40,49,38,"item"],[51,44,49,42],[51,49,49,47,"sum"],[51,52,49,50],[51,55,49,53,"item"],[51,59,49,57],[51,60,49,58,"value"],[51,65,49,63],[51,67,49,65],[51,68,49,66],[51,69,49,67],[52,8,50,6,"status"],[52,14,50,12],[52,16,50,14],[52,25,50,23],[53,8,51,6,"payer_signature"],[53,23,51,21],[53,25,51,23,"payerSignature"],[53,39,51,37],[54,8,52,6,"payee_signature"],[54,23,52,21],[54,25,52,23,"payeeSignature"],[55,6,53,4],[55,7,53,5],[56,6,55,4],[56,12,55,10],[56,16,55,14],[56,17,55,15,"saveTrade"],[56,26,55,24],[56,27,55,25,"trade"],[56,32,55,30],[56,33,55,31],[57,6,56,4],[57,13,56,11,"trade"],[57,18,56,16],[58,4,57,2],[59,4,59,2],[59,17,59,15,"saveTrade"],[59,26,59,24,"saveTrade"],[59,27,59,25,"trade"],[59,32,59,44],[59,34,59,61],[60,6,60,4],[60,12,60,10,"trades"],[60,18,60,16],[60,21,60,19],[60,27,60,25],[60,31,60,29],[60,32,60,30,"getPendingTrades"],[60,48,60,46],[60,49,60,47],[60,50,60,48],[61,6,61,4,"trades"],[61,12,61,10],[61,13,61,11,"push"],[61,17,61,15],[61,18,61,16,"trade"],[61,23,61,21],[61,24,61,22],[62,6,62,4],[62,12,62,10,"AsyncStorage"],[62,24,62,22],[62,25,62,22,"default"],[62,32,62,22],[62,33,62,23,"setItem"],[62,40,62,30],[62,41,62,31,"STORAGE_KEY"],[62,52,62,42],[62,54,62,44,"JSON"],[62,58,62,48],[62,59,62,49,"stringify"],[62,68,62,58],[62,69,62,59,"trades"],[62,75,62,65],[62,76,62,66],[62,77,62,67],[63,4,63,2],[64,4,65,2],[64,17,65,15,"getPendingTrades"],[64,33,65,31,"getPendingTrades"],[64,34,65,31],[64,36,65,59],[65,6,66,4],[65,10,66,8],[66,8,67,6],[66,14,67,12,"json"],[66,18,67,16],[66,21,67,19],[66,27,67,25,"AsyncStorage"],[66,39,67,37],[66,40,67,37,"default"],[66,47,67,37],[66,48,67,38,"getItem"],[66,55,67,45],[66,56,67,46,"STORAGE_KEY"],[66,67,67,57],[66,68,67,58],[67,8,68,6],[67,15,68,13,"json"],[67,19,68,17],[67,22,68,20,"JSON"],[67,26,68,24],[67,27,68,25,"parse"],[67,32,68,30],[67,33,68,31,"json"],[67,37,68,35],[67,38,68,36],[67,41,68,39],[67,43,68,41],[68,6,69,4],[68,7,69,5],[68,8,69,6],[68,15,69,13,"error"],[68,20,69,18],[68,22,69,20],[69,8,70,6,"console"],[69,15,70,13],[69,16,70,14,"error"],[69,21,70,19],[69,22,70,20],[69,53,70,51],[69,55,70,53,"error"],[69,60,70,58],[69,61,70,59],[70,8,71,6],[70,15,71,13],[70,17,71,15],[71,6,72,4],[72,4,73,2],[73,4,75,2],[73,17,75,15,"syncPendingTrades"],[73,34,75,32,"syncPendingTrades"],[73,35,75,32],[73,37,75,80],[74,6,76,4],[74,12,76,10,"trades"],[74,18,76,16],[74,21,76,19],[74,27,76,25],[74,31,76,29],[74,32,76,30,"getPendingTrades"],[74,48,76,46],[74,49,76,47],[74,50,76,48],[75,6,77,4],[75,10,77,8,"synced"],[75,16,77,14],[75,19,77,17],[75,20,77,18],[76,6,78,4],[76,10,78,8,"failed"],[76,16,78,14],[76,19,78,17],[76,20,78,18],[77,6,80,4],[77,11,80,9],[77,17,80,15,"trade"],[77,22,80,20],[77,26,80,24,"trades"],[77,32,80,30],[77,34,80,32],[78,8,81,6],[78,12,81,10,"trade"],[78,17,81,15],[78,18,81,16,"status"],[78,24,81,22],[78,29,81,27],[78,37,81,35],[78,39,81,37],[79,8,83,6],[79,12,83,10],[80,10,84,8],[80,16,84,14,"axios"],[80,21,84,19],[80,22,84,19,"default"],[80,29,84,19],[80,30,84,20,"post"],[80,34,84,24],[80,35,84,25],[80,38,84,28,"API_URL"],[80,45,84,35],[80,58,84,48],[80,60,84,50],[81,12,85,10,"payer_id"],[81,20,85,18],[81,22,85,20,"trade"],[81,27,85,25],[81,28,85,26,"payer_id"],[81,36,85,34],[82,12,86,10,"payee_id"],[82,20,86,18],[82,22,86,20,"trade"],[82,27,86,25],[82,28,86,26,"payee_id"],[82,36,86,34],[83,12,87,10,"items"],[83,17,87,15],[83,19,87,17,"trade"],[83,24,87,22],[83,25,87,23,"items"],[83,30,87,28],[84,12,88,10,"total_value"],[84,23,88,21],[84,25,88,23,"trade"],[84,30,88,28],[84,31,88,29,"total_value"],[84,42,88,40],[85,12,89,10,"payer_signature"],[85,27,89,25],[85,29,89,27,"trade"],[85,34,89,32],[85,35,89,33,"payer_signature"],[85,50,89,48],[86,12,90,10,"payee_signature"],[86,27,90,25],[86,29,90,27,"trade"],[86,34,90,32],[86,35,90,33,"payee_signature"],[87,10,91,8],[87,11,91,9],[87,12,91,10],[88,10,93,8,"trade"],[88,15,93,13],[88,16,93,14,"status"],[88,22,93,20],[88,25,93,23],[88,33,93,31],[89,10,94,8,"synced"],[89,16,94,14],[89,18,94,16],[90,8,95,6],[90,9,95,7],[90,10,95,8],[90,17,95,15,"error"],[90,22,95,20],[90,24,95,22],[91,10,96,8,"console"],[91,17,96,15],[91,18,96,16,"error"],[91,23,96,21],[91,24,96,22],[91,47,96,45],[91,49,96,47,"trade"],[91,54,96,52],[91,55,96,53,"trade_id"],[91,63,96,61],[91,65,96,63,"error"],[91,70,96,68],[91,71,96,69],[92,10,97,8,"trade"],[92,15,97,13],[92,16,97,14,"status"],[92,22,97,20],[92,25,97,23],[92,33,97,31],[93,10,98,8,"failed"],[93,16,98,14],[93,18,98,16],[94,8,99,6],[95,6,100,4],[96,6,102,4],[96,12,102,10,"remainingTrades"],[96,27,102,25],[96,30,102,28,"trades"],[96,36,102,34],[96,37,102,35,"filter"],[96,43,102,41],[96,44,102,43,"t"],[96,45,102,44],[96,49,102,49,"t"],[96,50,102,50],[96,51,102,51,"status"],[96,57,102,57],[96,62,102,62],[96,70,102,70],[96,71,102,71],[97,6,103,4],[97,12,103,10,"AsyncStorage"],[97,24,103,22],[97,25,103,22,"default"],[97,32,103,22],[97,33,103,23,"setItem"],[97,40,103,30],[97,41,103,31,"STORAGE_KEY"],[97,52,103,42],[97,54,103,44,"JSON"],[97,58,103,48],[97,59,103,49,"stringify"],[97,68,103,58],[97,69,103,59,"remainingTrades"],[97,84,103,74],[97,85,103,75],[97,86,103,76],[98,6,105,4],[98,13,105,11],[99,8,105,13,"synced"],[99,14,105,19],[100,8,105,21,"failed"],[101,6,105,28],[101,7,105,29],[102,4,106,2],[103,4,108,2],[103,17,108,15,"generateSignature"],[103,34,108,32,"generateSignature"],[103,35,108,33,"data"],[103,39,108,42],[103,41,108,44,"pin"],[103,44,108,55],[103,46,108,74],[104,6,109,4],[104,12,109,10,"dataString"],[104,22,109,20],[104,25,109,23,"JSON"],[104,29,109,27],[104,30,109,28,"stringify"],[104,39,109,37],[104,40,109,38,"data"],[104,44,109,42],[104,45,109,43],[105,6,110,4],[105,12,110,10,"combined"],[105,20,110,18],[105,23,110,21],[105,26,110,24,"dataString"],[105,36,110,34],[105,40,110,38,"pin"],[105,43,110,41],[105,45,110,43],[106,6,111,4],[106,12,111,10,"hash"],[106,16,111,14],[106,19,111,17],[106,25,111,23,"Crypto"],[106,31,111,29],[106,32,111,30,"digestStringAsync"],[106,49,111,47],[106,50,112,6,"Crypto"],[106,56,112,12],[106,57,112,13,"CryptoDigestAlgorithm"],[106,78,112,34],[106,79,112,35,"SHA256"],[106,85,112,41],[106,87,113,6,"combined"],[106,95,114,4],[106,96,114,5],[107,6,115,4],[107,13,115,11,"hash"],[107,17,115,15],[108,4,116,2],[109,4,118,2],[109,17,118,15,"clearAllTrades"],[109,31,118,29,"clearAllTrades"],[109,32,118,29],[109,34,118,47],[110,6,119,4],[110,12,119,10,"AsyncStorage"],[110,24,119,22],[110,25,119,22,"default"],[110,32,119,22],[110,33,119,23,"removeItem"],[110,43,119,33],[110,44,119,34,"STORAGE_KEY"],[110,55,119,45],[110,56,119,46],[111,4,120,2],[112,2,121,0],[113,0,121,1],[113,3]],"functionMap":{"names":["<global>","OfflineTradeService","recordTrade","items.reduce$argument_0","saveTrade","getPendingTrades","syncPendingTrades","trades.filter$argument_0","generateSignature","clearAllTrades"],"mappings":"AAA;OC8B;ECC;gCCiB,+BD;GDQ;EGE;GHI;EIE;GJQ;EKE;0CC2B,4BD;GLI;EOE;GPQ;EQE;GRE;CDC"},"hasCjsExports":false},"type":"js/module"}]}