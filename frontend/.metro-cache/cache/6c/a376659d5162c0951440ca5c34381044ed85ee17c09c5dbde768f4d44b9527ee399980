{"dependencies":[{"name":"./util","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":1,"column":11,"index":11},"end":{"line":1,"column":28,"index":28}}],"key":"hA8WsniBZrUJ/dmBZgrNdZcEmJ8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var util = require(_dependencyMap[0], \"./util\");\n  const CREDENTIAL_FIELD_ID = [0x10, 0x0e];\n  const SSID_FIELD_ID = [0x10, 0x45];\n  const AUTH_TYPE_FIELD_ID = [0x10, 0x03];\n  const NETWORK_KEY_FIELD_ID = [0x10, 0x27];\n  const AUTH_TYPES = {\n    OPEN: [0x00, 0x00],\n    WPA2_PSK: [0x00, 0x20]\n  };\n  function _getLengthBytes(valueBytes) {\n    if (valueBytes.length > 255) {\n      return [Math.floor(valueBytes.length / 256), valueBytes.length % 256];\n    }\n    return [0x0, valueBytes.length];\n  }\n  function _arrayEqual(arr1, arr2) {\n    if (arr1.length !== arr2.length) {\n      return false;\n    }\n    for (let i = 0; i < arr1.length; i++) {\n      if (arr1[i] !== arr2[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n  function _getNextTLV(bytes) {\n    const type = bytes.slice(0, 2);\n    const length = bytes.slice(2, 4);\n    const value = bytes.slice(4, 4 + (length[0] * 256 + length[1]));\n    return {\n      type,\n      length,\n      value\n    };\n  }\n\n  // @returns an string of wifi credentials\n  function decode(bytes) {\n    let result = {};\n    while (bytes.length > 0) {\n      let {\n        type,\n        value\n      } = _getNextTLV(bytes);\n      bytes = bytes.slice(4 + value.length, bytes.length);\n      if (_arrayEqual(CREDENTIAL_FIELD_ID, type)) {\n        let credential = value;\n        while (credential.length > 0) {\n          let tlv = _getNextTLV(credential);\n          credential = credential.slice(4 + tlv.value.length, credential.length);\n          if (_arrayEqual(AUTH_TYPE_FIELD_ID, tlv.type)) {\n            result.authType = tlv.value;\n          } else if (_arrayEqual(SSID_FIELD_ID, tlv.type)) {\n            result.ssid = util.bytesToString(tlv.value);\n          } else if (_arrayEqual(NETWORK_KEY_FIELD_ID, tlv.type)) {\n            result.networkKey = util.bytesToString(tlv.value);\n          }\n        }\n      }\n    }\n    return result;\n  }\n\n  // encode wifi object payload\n  // @returns an array of bytes\n  function encode({\n    ssid,\n    networkKey,\n    authType = AUTH_TYPES.WPA2_PSK\n  }) {\n    if (typeof ssid !== 'string' || typeof networkKey !== 'string') {\n      throw new Error('');\n    }\n    ssid = util.stringToBytes(ssid);\n    networkKey = util.stringToBytes(networkKey);\n\n    // build seperated TLV\n    const authTypeTLV = [...AUTH_TYPE_FIELD_ID, 0x0, authType.length, ...authType];\n    const ssidTLV = [...SSID_FIELD_ID, 0x0, ssid.length, ...ssid];\n    const networkKeyTLV = [...NETWORK_KEY_FIELD_ID, 0x0, networkKey.length, ...networkKey];\n\n    // build credential TLV\n    const credentialValue = [...authTypeTLV, ...ssidTLV, ...networkKeyTLV];\n    const credentialTLV = [...CREDENTIAL_FIELD_ID, ..._getLengthBytes(credentialValue), ...credentialValue];\n    return credentialTLV;\n  }\n  module.exports = {\n    encodePayload: encode,\n    decodePayload: decode,\n    authTypes: AUTH_TYPES\n  };\n});","lineCount":94,"map":[[2,2,1,0],[2,6,1,4,"util"],[2,10,1,8],[2,13,1,11,"require"],[2,20,1,18],[2,21,1,18,"_dependencyMap"],[2,35,1,18],[2,48,1,27],[2,49,1,28],[3,2,3,0],[3,8,3,6,"CREDENTIAL_FIELD_ID"],[3,27,3,25],[3,30,3,28],[3,31,3,29],[3,35,3,33],[3,37,3,35],[3,41,3,39],[3,42,3,40],[4,2,4,0],[4,8,4,6,"SSID_FIELD_ID"],[4,21,4,19],[4,24,4,22],[4,25,4,23],[4,29,4,27],[4,31,4,29],[4,35,4,33],[4,36,4,34],[5,2,5,0],[5,8,5,6,"AUTH_TYPE_FIELD_ID"],[5,26,5,24],[5,29,5,27],[5,30,5,28],[5,34,5,32],[5,36,5,34],[5,40,5,38],[5,41,5,39],[6,2,6,0],[6,8,6,6,"NETWORK_KEY_FIELD_ID"],[6,28,6,26],[6,31,6,29],[6,32,6,30],[6,36,6,34],[6,38,6,36],[6,42,6,40],[6,43,6,41],[7,2,8,0],[7,8,8,6,"AUTH_TYPES"],[7,18,8,16],[7,21,8,19],[8,4,9,2,"OPEN"],[8,8,9,6],[8,10,9,8],[8,11,9,9],[8,15,9,13],[8,17,9,15],[8,21,9,19],[8,22,9,20],[9,4,10,2,"WPA2_PSK"],[9,12,10,10],[9,14,10,12],[9,15,10,13],[9,19,10,17],[9,21,10,19],[9,25,10,23],[10,2,11,0],[10,3,11,1],[11,2,13,0],[11,11,13,9,"_getLengthBytes"],[11,26,13,24,"_getLengthBytes"],[11,27,13,25,"valueBytes"],[11,37,13,35],[11,39,13,37],[12,4,14,2],[12,8,14,6,"valueBytes"],[12,18,14,16],[12,19,14,17,"length"],[12,25,14,23],[12,28,14,26],[12,31,14,29],[12,33,14,31],[13,6,15,4],[13,13,15,11],[13,14,15,12,"Math"],[13,18,15,16],[13,19,15,17,"floor"],[13,24,15,22],[13,25,15,23,"valueBytes"],[13,35,15,33],[13,36,15,34,"length"],[13,42,15,40],[13,45,15,43],[13,48,15,46],[13,49,15,47],[13,51,15,49,"valueBytes"],[13,61,15,59],[13,62,15,60,"length"],[13,68,15,66],[13,71,15,69],[13,74,15,72],[13,75,15,73],[14,4,16,2],[15,4,17,2],[15,11,17,9],[15,12,17,10],[15,15,17,13],[15,17,17,15,"valueBytes"],[15,27,17,25],[15,28,17,26,"length"],[15,34,17,32],[15,35,17,33],[16,2,18,0],[17,2,20,0],[17,11,20,9,"_arrayEqual"],[17,22,20,20,"_arrayEqual"],[17,23,20,21,"arr1"],[17,27,20,25],[17,29,20,27,"arr2"],[17,33,20,31],[17,35,20,33],[18,4,21,2],[18,8,21,6,"arr1"],[18,12,21,10],[18,13,21,11,"length"],[18,19,21,17],[18,24,21,22,"arr2"],[18,28,21,26],[18,29,21,27,"length"],[18,35,21,33],[18,37,21,35],[19,6,22,4],[19,13,22,11],[19,18,22,16],[20,4,23,2],[21,4,25,2],[21,9,25,7],[21,13,25,11,"i"],[21,14,25,12],[21,17,25,15],[21,18,25,16],[21,20,25,18,"i"],[21,21,25,19],[21,24,25,22,"arr1"],[21,28,25,26],[21,29,25,27,"length"],[21,35,25,33],[21,37,25,35,"i"],[21,38,25,36],[21,40,25,38],[21,42,25,40],[22,6,26,4],[22,10,26,8,"arr1"],[22,14,26,12],[22,15,26,13,"i"],[22,16,26,14],[22,17,26,15],[22,22,26,20,"arr2"],[22,26,26,24],[22,27,26,25,"i"],[22,28,26,26],[22,29,26,27],[22,31,26,29],[23,8,27,6],[23,15,27,13],[23,20,27,18],[24,6,28,4],[25,4,29,2],[26,4,31,2],[26,11,31,9],[26,15,31,13],[27,2,32,0],[28,2,34,0],[28,11,34,9,"_getNextTLV"],[28,22,34,20,"_getNextTLV"],[28,23,34,21,"bytes"],[28,28,34,26],[28,30,34,28],[29,4,35,2],[29,10,35,8,"type"],[29,14,35,12],[29,17,35,15,"bytes"],[29,22,35,20],[29,23,35,21,"slice"],[29,28,35,26],[29,29,35,27],[29,30,35,28],[29,32,35,30],[29,33,35,31],[29,34,35,32],[30,4,36,2],[30,10,36,8,"length"],[30,16,36,14],[30,19,36,17,"bytes"],[30,24,36,22],[30,25,36,23,"slice"],[30,30,36,28],[30,31,36,29],[30,32,36,30],[30,34,36,32],[30,35,36,33],[30,36,36,34],[31,4,37,2],[31,10,37,8,"value"],[31,15,37,13],[31,18,37,16,"bytes"],[31,23,37,21],[31,24,37,22,"slice"],[31,29,37,27],[31,30,37,28],[31,31,37,29],[31,33,37,31],[31,34,37,32],[31,38,37,36,"length"],[31,44,37,42],[31,45,37,43],[31,46,37,44],[31,47,37,45],[31,50,37,48],[31,53,37,51],[31,56,37,54,"length"],[31,62,37,60],[31,63,37,61],[31,64,37,62],[31,65,37,63],[31,66,37,64],[31,67,37,65],[32,4,38,2],[32,11,38,9],[33,6,39,4,"type"],[33,10,39,8],[34,6,40,4,"length"],[34,12,40,10],[35,6,41,4,"value"],[36,4,42,2],[36,5,42,3],[37,2,43,0],[39,2,45,0],[40,2,46,0],[40,11,46,9,"decode"],[40,17,46,15,"decode"],[40,18,46,16,"bytes"],[40,23,46,21],[40,25,46,23],[41,4,47,2],[41,8,47,6,"result"],[41,14,47,12],[41,17,47,15],[41,18,47,16],[41,19,47,17],[42,4,49,2],[42,11,49,9,"bytes"],[42,16,49,14],[42,17,49,15,"length"],[42,23,49,21],[42,26,49,24],[42,27,49,25],[42,29,49,27],[43,6,50,4],[43,10,50,8],[44,8,50,9,"type"],[44,12,50,13],[45,8,50,15,"value"],[46,6,50,20],[46,7,50,21],[46,10,50,24,"_getNextTLV"],[46,21,50,35],[46,22,50,36,"bytes"],[46,27,50,41],[46,28,50,42],[47,6,51,4,"bytes"],[47,11,51,9],[47,14,51,12,"bytes"],[47,19,51,17],[47,20,51,18,"slice"],[47,25,51,23],[47,26,51,24],[47,27,51,25],[47,30,51,28,"value"],[47,35,51,33],[47,36,51,34,"length"],[47,42,51,40],[47,44,51,42,"bytes"],[47,49,51,47],[47,50,51,48,"length"],[47,56,51,54],[47,57,51,55],[48,6,53,4],[48,10,53,8,"_arrayEqual"],[48,21,53,19],[48,22,53,20,"CREDENTIAL_FIELD_ID"],[48,41,53,39],[48,43,53,41,"type"],[48,47,53,45],[48,48,53,46],[48,50,53,48],[49,8,54,6],[49,12,54,10,"credential"],[49,22,54,20],[49,25,54,23,"value"],[49,30,54,28],[50,8,56,6],[50,15,56,13,"credential"],[50,25,56,23],[50,26,56,24,"length"],[50,32,56,30],[50,35,56,33],[50,36,56,34],[50,38,56,36],[51,10,57,8],[51,14,57,12,"tlv"],[51,17,57,15],[51,20,57,18,"_getNextTLV"],[51,31,57,29],[51,32,57,30,"credential"],[51,42,57,40],[51,43,57,41],[52,10,58,8,"credential"],[52,20,58,18],[52,23,58,21,"credential"],[52,33,58,31],[52,34,58,32,"slice"],[52,39,58,37],[52,40,58,38],[52,41,58,39],[52,44,58,42,"tlv"],[52,47,58,45],[52,48,58,46,"value"],[52,53,58,51],[52,54,58,52,"length"],[52,60,58,58],[52,62,58,60,"credential"],[52,72,58,70],[52,73,58,71,"length"],[52,79,58,77],[52,80,58,78],[53,10,60,8],[53,14,60,12,"_arrayEqual"],[53,25,60,23],[53,26,60,24,"AUTH_TYPE_FIELD_ID"],[53,44,60,42],[53,46,60,44,"tlv"],[53,49,60,47],[53,50,60,48,"type"],[53,54,60,52],[53,55,60,53],[53,57,60,55],[54,12,61,10,"result"],[54,18,61,16],[54,19,61,17,"authType"],[54,27,61,25],[54,30,61,28,"tlv"],[54,33,61,31],[54,34,61,32,"value"],[54,39,61,37],[55,10,62,8],[55,11,62,9],[55,17,62,15],[55,21,62,19,"_arrayEqual"],[55,32,62,30],[55,33,62,31,"SSID_FIELD_ID"],[55,46,62,44],[55,48,62,46,"tlv"],[55,51,62,49],[55,52,62,50,"type"],[55,56,62,54],[55,57,62,55],[55,59,62,57],[56,12,63,10,"result"],[56,18,63,16],[56,19,63,17,"ssid"],[56,23,63,21],[56,26,63,24,"util"],[56,30,63,28],[56,31,63,29,"bytesToString"],[56,44,63,42],[56,45,63,43,"tlv"],[56,48,63,46],[56,49,63,47,"value"],[56,54,63,52],[56,55,63,53],[57,10,64,8],[57,11,64,9],[57,17,64,15],[57,21,64,19,"_arrayEqual"],[57,32,64,30],[57,33,64,31,"NETWORK_KEY_FIELD_ID"],[57,53,64,51],[57,55,64,53,"tlv"],[57,58,64,56],[57,59,64,57,"type"],[57,63,64,61],[57,64,64,62],[57,66,64,64],[58,12,65,10,"result"],[58,18,65,16],[58,19,65,17,"networkKey"],[58,29,65,27],[58,32,65,30,"util"],[58,36,65,34],[58,37,65,35,"bytesToString"],[58,50,65,48],[58,51,65,49,"tlv"],[58,54,65,52],[58,55,65,53,"value"],[58,60,65,58],[58,61,65,59],[59,10,66,8],[60,8,67,6],[61,6,68,4],[62,4,69,2],[63,4,71,2],[63,11,71,9,"result"],[63,17,71,15],[64,2,72,0],[66,2,74,0],[67,2,75,0],[68,2,76,0],[68,11,76,9,"encode"],[68,17,76,15,"encode"],[68,18,76,16],[69,4,76,17,"ssid"],[69,8,76,21],[70,4,76,23,"networkKey"],[70,14,76,33],[71,4,76,35,"authType"],[71,12,76,43],[71,15,76,46,"AUTH_TYPES"],[71,25,76,56],[71,26,76,57,"WPA2_PSK"],[72,2,76,65],[72,3,76,66],[72,5,76,68],[73,4,77,2],[73,8,77,6],[73,15,77,13,"ssid"],[73,19,77,17],[73,24,77,22],[73,32,77,30],[73,36,77,34],[73,43,77,41,"networkKey"],[73,53,77,51],[73,58,77,56],[73,66,77,64],[73,68,77,66],[74,6,78,4],[74,12,78,10],[74,16,78,14,"Error"],[74,21,78,19],[74,22,78,20],[74,24,78,22],[74,25,78,23],[75,4,79,2],[76,4,81,2,"ssid"],[76,8,81,6],[76,11,81,9,"util"],[76,15,81,13],[76,16,81,14,"stringToBytes"],[76,29,81,27],[76,30,81,28,"ssid"],[76,34,81,32],[76,35,81,33],[77,4,82,2,"networkKey"],[77,14,82,12],[77,17,82,15,"util"],[77,21,82,19],[77,22,82,20,"stringToBytes"],[77,35,82,33],[77,36,82,34,"networkKey"],[77,46,82,44],[77,47,82,45],[79,4,84,2],[80,4,85,2],[80,10,85,8,"authTypeTLV"],[80,21,85,19],[80,24,85,22],[80,25,86,4],[80,28,86,7,"AUTH_TYPE_FIELD_ID"],[80,46,86,25],[80,48,87,4],[80,51,87,7],[80,53,88,4,"authType"],[80,61,88,12],[80,62,88,13,"length"],[80,68,88,19],[80,70,89,4],[80,73,89,7,"authType"],[80,81,89,15],[80,82,90,3],[81,4,91,2],[81,10,91,8,"ssidTLV"],[81,17,91,15],[81,20,91,18],[81,21,91,19],[81,24,91,22,"SSID_FIELD_ID"],[81,37,91,35],[81,39,91,37],[81,42,91,40],[81,44,91,42,"ssid"],[81,48,91,46],[81,49,91,47,"length"],[81,55,91,53],[81,57,91,55],[81,60,91,58,"ssid"],[81,64,91,62],[81,65,91,63],[82,4,92,2],[82,10,92,8,"networkKeyTLV"],[82,23,92,21],[82,26,92,24],[82,27,93,4],[82,30,93,7,"NETWORK_KEY_FIELD_ID"],[82,50,93,27],[82,52,94,4],[82,55,94,7],[82,57,95,4,"networkKey"],[82,67,95,14],[82,68,95,15,"length"],[82,74,95,21],[82,76,96,4],[82,79,96,7,"networkKey"],[82,89,96,17],[82,90,97,3],[84,4,99,2],[85,4,100,2],[85,10,100,8,"credentialValue"],[85,25,100,23],[85,28,100,26],[85,29,100,27],[85,32,100,30,"authTypeTLV"],[85,43,100,41],[85,45,100,43],[85,48,100,46,"ssidTLV"],[85,55,100,53],[85,57,100,55],[85,60,100,58,"networkKeyTLV"],[85,73,100,71],[85,74,100,72],[86,4,101,2],[86,10,101,8,"credentialTLV"],[86,23,101,21],[86,26,101,24],[86,27,102,4],[86,30,102,7,"CREDENTIAL_FIELD_ID"],[86,49,102,26],[86,51,103,4],[86,54,103,7,"_getLengthBytes"],[86,69,103,22],[86,70,103,23,"credentialValue"],[86,85,103,38],[86,86,103,39],[86,88,104,4],[86,91,104,7,"credentialValue"],[86,106,104,22],[86,107,105,3],[87,4,107,2],[87,11,107,9,"credentialTLV"],[87,24,107,22],[88,2,108,0],[89,2,110,0,"module"],[89,8,110,6],[89,9,110,7,"exports"],[89,16,110,14],[89,19,110,17],[90,4,111,2,"encodePayload"],[90,17,111,15],[90,19,111,17,"encode"],[90,25,111,23],[91,4,112,2,"decodePayload"],[91,17,112,15],[91,19,112,17,"decode"],[91,25,112,23],[92,4,113,2,"authTypes"],[92,13,113,11],[92,15,113,13,"AUTH_TYPES"],[93,2,114,0],[93,3,114,1],[94,0,114,2],[94,3]],"functionMap":{"names":["<global>","_getLengthBytes","_arrayEqual","_getNextTLV","decode","encode"],"mappings":"AAA;ACY;CDK;AEE;CFY;AGE;CHS;AIG;CJ0B;AKI;CLgC"},"hasCjsExports":true},"type":"js/module"}]}